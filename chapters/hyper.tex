\chapter{HyPer}\label{chapter:hyper}
\section{Motivation}
In this section, the relational main-memory database system HyPer is introduced. HyPer is a database system combining both OLTP and OLAP processing and is the main research subject of this work: Extending HyPer in order to execute data mining algorithms directly in the relational database.
\\
As already mentioned, historically, databases are disk-based systems separated into two parts: An OLTP system, optimized for high rates of mission-critical, transactional write requests, and an OLTP system, executing long-running queries. The data synchronization between the two systems is ensured with an ETL process: Data is extracted from the OLTP system, transformed and loaded into the OLAP system. Since this process implicates heavy load on the database, it is usually done periodically, e.g. over night. 
\\
Obviously, this architecture reveals several drawbacks. The periodical execution of the ETL process results in stale data in the OLAP system, i.e. when implementing a nightly ETL process, data can be outdated for up to 24 hours which can be problematic for real-time data analysis problems. Furthermore, two systems lead to a higher amount of infrastructure and maintaining cost. Hardware and software costs must be taken into account, as well as maintenance cost and incident management. Additionally, implementing an ETL process can make a system overly complex in contrast of having one system.
\\
Addressing these challenges the HyPer main-memory system was developed, with the goals to process OLTP transactions with high performance and throughput, and, on the same system, process OLAP queries on up-to-date data. 

\section{Architecture}
In the following we give a short overview about the HyPer system architecture. Major performance gains are realized by omitting typical disk-based database characteristics, that are not necessary any more when data resides in main memory. Therefore, database-specific buffer management and page structuring is not needed. Instead, data is stored in main-memory optimized data structures within the virtual memory. Hence, HyPer can use the highly efficient address-translation of the operating system without any additional indirection.
\\
OLTP processing is highly efficient because all the data is already loaded in main memory, and the very slow disk access is omitted and not a bottleneck anymore. Therefore, transactions do never have to wait for I/O and can be executed very quick. Thus, HyPer implements OLTP transactions as single-threaded approach and executes all transactions sequentially. This is possible because the execution time of an OLTP transaction is only around ten microseconds and even without parallel execution of transactions, a high throughput is achievable. Another advantage of this simple model is that locking and latching of data objects become redundant since only one transaction is active for the entire database.
\\
Obviously, the sequential execution of transactions is only possible if there arenâ€™t any long-running transactions. Long-running transactions would be a bottleneck for the entire database and must be handled in a different way. Therefore we will now look at how HyPer deals with long-running queries and OLAP-style queries in general.
\\
HyPer considers OLAP queries as a new process and creates a snapshot of the virtual memory of the OLTP process for its OLAP processes. In Unix, this is done by forking the OLTP process and creating a child process for the OLAP process, exploiting the virtual memory functionality of the operating system. The OLAP process takes an exact copy of the OLTP system on process creation, and is now able to execute long running queries without interfering the OLTP transaction throughput. Thanks to modern operating systems, the creation of snapshots is very efficient because the memory segments are not physically copied. Instead, operating systems apply a copy-on-update strategy. That means, that both OLTP and OLAP process are sharing the same physical main memory location since their virtual address translation maps to the same segments. Therefore copying the memory on creation is not necessary. Only when an object is updated by the OLTP process, a new page gets created for the OLTP process, while the OLAP virtual memory page is still the one available when the process was created. Since this mechanism is supported by hardware, it is very fast and efficient without any implementation overhead for the HyPer database system. Experiments have also shown that a \texttt{fork} can be achieved in about 10 ms, almost independent of the size of the OLTP system.
\\
So far we have shown how HyPer executes long-running OLAP queries parallel to high-throughput OLTP transactions by using virtual memory snapshots. Since OLAP queries are read-only HyPer can execute them in parallel in multiple threads sharing the same snapshot. As in the sequential execution, locking and latching is not necessary because the used data structures are immutable. This inter-query parallelization can tremendously speed up query processing on multicore computers.
\\
Another approach is the creation of multiple OLAP session by forking the OLTP memory periodically. Therefore, for each OLAP session a new virtual memory snapshot is created and used as the current snapshot for the new session. This allows parallelization not only as inter-query parallelization but also among the different OLAP sessions.
\\ 
In this chapter we have shown the advantages of a modern main-memory system such as HyPer. Without the bottleneck of disk I/O, database operations can be run sequentially with an appropriate throughput. OLAP queries can run very efficiently in parallel to the OLTP transaction system on different virtual memory snapshots. Due to these possibilties we explore now how to not only execute OLAP queries on a running transactional database, but also data mining algorithms.


